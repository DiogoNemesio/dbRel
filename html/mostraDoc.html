<form class="form-horizontal" id="zgBodyDocFormID" action="#" method="post" enctype="multipart/form-data">
<input type="hidden" name="codConsulta" id='codConsultaID' value="%COD_CONSULTA%">
<input type="hidden" name="codTipoDoc" id='codTipoDocID' value="%COD_TIPO_DOC%">
<div class="control-group"><label class="control-label" style="width:240px;" for="nomeID">Descrição&nbsp;</label>
	<div class="controls">
		<div class="input-prepend">
			<span class="add-on"><i class="icon-file-alt"></i></span>
			<input class="input-large" id="nomeID" type="text" name="nome" minlength="2" maxlength="30" required autocomplete="off">
		</div>
	</div>
</div>
%DIV_HTML%
</form>
<script>
	$('input,textarea').jqBootstrapValidation({
		preventSubmit: true
	});

	function mostraAlerta(pMsg) {
		$('#alertModalID').html('<button type=\"button\" class=\"close\" data-dismiss=\"alert\">&times;</button><p>'+pMsg+'</p>');
		$('#alertModalID').show();	
	}
	
	$('#zgBodyDocFormID').submit(function() {
		var formData = new FormData(document.getElementById('zgBodyDocFormID'));
		$.ajax({
			type: 		'post',
			url: 		'%DP_URL%/uploadDoc.dp.php',
			xhr: function() {  // custom xhr
                myXhr = $.ajaxSettings.xhr();
                if(myXhr.upload){ // if upload property exists
                    myXhr.upload.addEventListener('progress', progressHandlingFunction, false); // progressbar
                }
                return myXhr;
            },
            data: 			formData,
            cache: 			false,
            contentType: 	false,
            processData: 	false
		}).done(function( data, textStatus, jqXHR) {
			alert(data);
		}).fail(function( jqXHR, textStatus, errorThrown) {
			alert('1||'+errorThrown);
		});
		return false; 
	});
	
	$('#submitModalDoc').click(function() {
		$('#zgBodyDocFormID').submit();
	});
	
	function progressHandlingFunction(e){
        if(e.lengthComputable){
            $('progress').attr({value:e.loaded,max:e.total});
            $('#prc').html(e.loaded);
        }
    }
	
</script>
